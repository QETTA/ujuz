# 09. Design QA Baseline (UjuZ)

## 목차
- [1. 목적과 범위](#1-목적과-범위)
- [2. 접근성 QA 체크리스트 (WCAG 2.2, 웹+모바일)](#2-접근성-qa-체크리스트-wcag-22-웹모바일)
- [3. TO 알림/푸시 권한 테스트 시나리오](#3-to-알림푸시-권한-테스트-시나리오)
- [4. 위치 권한 테스트 시나리오](#4-위치-권한-테스트-시나리오)
- [5. 디자인 핸드오프 체크리스트](#5-디자인-핸드오프-체크리스트)
- [6. 크로스 플랫폼 렌더링 체크](#6-크로스-플랫폼-렌더링-체크)
- [7. 색상 대비 검증 표](#7-색상-대비-검증-표)
- [8. 릴리즈 게이트 기준 (필수 6개)](#8-릴리즈-게이트-기준-필수-6개)

## 1. 목적과 범위
이 문서는 UjuZ의 디자인 QA 기준선을 정의한다.
대상은 웹(Next.js) + 모바일(Expo iOS/Android)이며, 핵심 퍼널은 `시설 탐색`, `시설 비교`, `TO 알림`, `입학상담/결제`다.

## 2. 접근성 QA 체크리스트 (WCAG 2.2, 웹+모바일)
### 2.1 공통 (WCAG 2.2)
- [ ] 텍스트 대비: 일반 텍스트 4.5:1 이상, 큰 텍스트 3:1 이상
- [ ] 비텍스트 UI(아이콘/차트/포커스링) 3:1 이상
- [ ] 색상 단독 전달 금지(아이콘/텍스트/형태 동시 제공)
- [ ] 포커스 가시성 확보(키보드/보조기기 이동 시 현재 위치 식별 가능)
- [ ] 포커스가 헤더/고정 UI에 가려지지 않음(Focus Not Obscured)
- [ ] 드래그 기반 기능에 탭/버튼 대체 경로 제공(Dragging Movements)
- [ ] 오류 메시지에 원인 + 복구 행동 포함
- [ ] 로딩/성공/오류 상태가 시각 + 스크린리더 모두에 전달

### 2.2 웹 체크
- [ ] Tab 순서가 시각 순서와 동일
- [ ] Skip link 동작(키보드 첫 진입 시 본문으로 이동)
- [ ] 모달 오픈 시 포커스 트랩/종료 후 원위치 복귀
- [ ] 200% 확대에서도 CTA/폼 접근 가능
- [ ] 마우스 없이 핵심 과업 5개(탐색/비교/알림설정/상담/결제) 수행 가능

### 2.3 모바일 체크 (iOS/Android)
- [ ] VoiceOver/TalkBack 라벨이 실제 의미와 일치
- [ ] 터치 타깃: iOS 44pt+, Android 48dp+ 유지
- [ ] Dynamic Type / Font Scale 확대 시 텍스트 잘림 없음
- [ ] Safe Area 침범 없음(상단 노치, 하단 홈 인디케이터)
- [ ] Reduce Motion에서 핵심 정보 손실 없음

## 3. TO 알림/푸시 권한 테스트 시나리오
| 케이스 | 사전 조건 | 테스트 절차 | 기대 결과 | 필수 확인 포인트 |
|---|---|---|---|---|
| 허용(Allow) | 최초 설치, 알림 권한 미결정 | 시설 상세에서 `TO 알림 받기` 탭 -> 프리프롬프트 확인 -> 시스템 권한 허용 | 구독 생성 성공, 확인 토스트/상태 노출, 테스트 푸시 수신 가능 | 앱 첫 진입 시 자동 권한 요청이 없어야 함 |
| 거절(Deny) | 최초 설치, 알림 권한 미결정 | `TO 알림 받기` 탭 -> 프리프롬프트 -> 시스템 권한 거절 | 기능 폴백 제공(앱 내 알림센터/수동 확인), 거절 상태 안내 문구 노출 | 거절 직후 무한 재요청 금지, 설정 이동 CTA 제공 |
| 철회(Revoke) | 과거 허용 후 OS 설정에서 알림 OFF | 앱 재실행 또는 알림 설정 화면 진입 | 기존 구독은 유지되더라도 실수신 불가 상태가 명확히 표시, 재허용 경로 제공 | `권한 꺼짐` 배너/상태, TO 알림 토글 동작 일관성 |

권장 로그 검증:
- `perm_push_preprompt_view`
- `perm_push_system_result` (`granted|denied`)
- `perm_settings_open`

## 4. 위치 권한 테스트 시나리오
| 케이스 | 플랫폼 | 테스트 절차 | 기대 결과 | 판정 기준 |
|---|---|---|---|---|
| 허용(Allow) | iOS/Android/Web | `내 주변 시설` 또는 `거리순 정렬` 진입 시 권한 허용 | 현재 위치 기반 정렬/지도 중심 이동 정상 동작 | 거리 정보와 지도 핀이 현재 위치 기준으로 업데이트 |
| 거절(Deny) | iOS/Android/Web | 동일 진입 경로에서 권한 거절 | `지역 직접 선택` 폴백 제공, 핵심 탐색/비교는 계속 가능 | 권한이 없어도 퍼널 이탈 없이 과업 지속 가능 |
| When In Use | iOS | `When In Use` 허용 후 포그라운드 탐색 | 앱 사용 중 위치 기능 정상, 백그라운드 강제 요구 없음 | 초기 릴리즈에서 Always 업셀 금지 |
| Always | iOS | 설정에서 Always 허용 상태로 앱 재진입 | 추가 이점이 없더라도 기능 이상 없음, 과도 수집/카피 없음 | Always 미필수 정책 준수(과도 권한 유도 금지) |

## 5. 디자인 핸드오프 체크리스트
- [ ] 토큰 일치: Figma 색/타입/간격/라운드가 코드 토큰(`brand-*`, `surface-*`, `text-*`)과 1:1 매핑됨
- [ ] 상태 누락 없음: `default`, `loading`, `empty`, `error`, `disabled`, `permission-denied`, `offline`
- [ ] 다크모드 포함: 동일 화면/상태의 다크 변형이 모두 존재
- [ ] Dynamic Type 포함: iOS `AX1~AX5`, Android `1.3/1.5/2.0` 대응 시안/룰 제공
- [ ] 카피 명세 포함: 권한 프리프롬프트/거절 후 안내/오류 복구 문구 확정
- [ ] 인터랙션 명세 포함: 전환, 스켈레톤, 토스트, 포커스/키보드 동작 정의

## 6. 크로스 플랫폼 렌더링 체크
| 항목 | iOS | Android | Web | QA 체크 포인트 |
|---|---|---|---|---|
| 폰트 렌더링 | San Francisco 계열 | Roboto 계열 | 시스템 폰트 스택 | 같은 토큰이어도 줄바꿈 위치 차이 확인 |
| 그림자/입체감 | blur 중심 shadow | elevation 영향 큼 | box-shadow 일관 | 카드 경계가 사라지지 않는지 확인 |
| Safe Area/키보드 | 노치/홈 인디케이터 영향 큼 | 제스처/소프트키 영향 | 브라우저 UI 가변 | 하단 CTA 가림 여부 확인 |
| 권한 UX | 시스템 시트(세분화 높음) | OS/제조사 변형 존재 | 브라우저별 권한 UI 상이 | 프리프롬프트 + 폴백 경로 일관성 |
| 지도/위치 정확도 | 정밀/대략 선택 가능 | 기기별 센서 편차 | 브라우저 geolocation 의존 | 거리/정렬 오차 허용 범위 정의 |
| 스크롤/제스처 | 탄성 스크롤 | 백 제스처 간섭 가능 | 휠/트랙패드 | 바텀시트/탭 전환 충돌 여부 확인 |

## 7. 색상 대비 검증 표
기준 토큰: `src/app/globals.css` fallback hex 값 (`#6d5ce7`, `#ffffff`, `#fafaff`, `#f3f2fa`, `#1a1730`, `#6b6580`, `#807b93`)

| 조합 (FG on BG) | Contrast Ratio | WCAG AA 일반텍스트 | 권장 사용 |
|---|---:|---|---|
| `text-primary` on `surface` | 17.37:1 | 통과 | 본문/제목/핵심 수치 |
| `text-secondary` on `surface` | 5.53:1 | 통과 | 보조 본문/설명 |
| `text-tertiary` on `surface` | 4.06:1 | 미통과 | 메타/캡션(큰 텍스트 또는 비핵심 정보) |
| `brand-500` on `surface` | 4.84:1 | 통과 | 링크/강조 텍스트 |
| `text-inverse` on `brand-500` | 4.84:1 | 통과 | 주요 버튼 라벨 |
| `text-primary` on `surface-inset` | 15.62:1 | 통과 | 인셋 카드 본문 |
| `text-secondary` on `surface-inset` | 4.97:1 | 통과 | 인셋 보조 텍스트 |
| `text-tertiary` on `surface-inset` | 3.65:1 | 미통과 | 장문 본문 금지, 부가 라벨만 허용 |

운영 규칙:
1. 본문/입력/CTA 텍스트는 `4.5:1` 미만 조합 사용 금지.
2. `text-tertiary`는 상태 메타/보조 라벨에 한정.
3. 다크모드는 동일 조합을 별도 재측정 후 릴리즈 체크리스트에 첨부.

## 8. 릴리즈 게이트 기준 (필수 6개)
아래 6개가 모두 `PASS`일 때만 배포 가능:

1. 접근성 핵심 과업 PASS: 웹 키보드 + iOS VoiceOver + Android TalkBack으로 핵심 과업 5개 완료
2. 푸시 권한 시나리오 PASS: 허용/거절/철회 3케이스 모두 폴백 포함 정상
3. 위치 권한 시나리오 PASS: 허용/거절/When In Use/Always 4케이스 정상
4. 대비 기준 PASS: 본문/CTA 텍스트 조합 4.5:1 이상, 예외 항목 문서화 완료
5. 핸드오프 무결성 PASS: 토큰/상태/다크모드/Dynamic Type 누락 0건
6. 크로스 플랫폼 스모크 PASS: iOS/Android/Web 동일 시나리오에서 Blocker 0건

권장 산출물:
- QA 체크리스트 캡처
- 권한 시나리오 녹화(3~5분)
- 플랫폼별 스크린샷(동일 화면, 동일 상태)
- 대비 측정 결과표
